<div class="container">
  <div class="row">
    <div class="col">
      <canvas *ngIf="isBrowser" baseChart [data]="requestByIsFreeData" [type]="'doughnut'"
      [options]="requestByIsFreeChartOptions" class="admin_graphic">
    </canvas>
    </div>
    <div class="col">
      <canvas *ngIf="isBrowser" baseChart [data]="requestByTypeData" [type]="'bar'" [options]="requestByTypeChartOptions"
    class="admin_graphic">
  </canvas>
    </div>
  </div>
</div>

<div class="row admin__request-tools">


  

<!-- Sorting -->
<!-- <div>
    <label>Sort By:</label>
    <select [(ngModel)]="sortBy" (change)="sort($event)">
      <option value="label">Label</option>
      <option value="description">Description</option>
    </select>
    <label>Sort Order:</label>
    <select [(ngModel)]="sortOrder" (change)="sort(sortBy)">
      <option value="asc">Ascending</option>
      <option value="desc">Descending</option>
    </select>
  </div> -->
</div>
<div class="row admin__request-table">
  <div class="table__tools">
    <h3>Demandes d'Organisation</h3>
    <button class="btn btn-sm btn-export" (click)="exportToExcel()">Exporter</button>
  </div>

  <table class="table mt-5">
    <thead>
      <tr>
        <th>Détails</th>
        <th>Info de Contact</th>
        <th>Préstations Demandées</th>
        <th>
          <input type="text" [(ngModel)]="codeFilter" (input)="filter('code', codeFilter)"
            class="form__input tools__search" placeholder="Code">
        </th>
        <th (click)="sort('label')">
          <input type="text" [(ngModel)]="labelFilter" (input)="filter('label', labelFilter)"
            class="form__input tools__search" placeholder="Libellé">
        </th>
        <th (click)="sort('description')">
          <input type="text" [(ngModel)]="descriptionFilter" (input)="filter('description', descriptionFilter)"
            class="form__input tools__search" placeholder="Description">
        </th>
        <th>
          <input type="text" [(ngModel)]="typeFilter" (input)="filter('type', typeFilter)"
            class="form__input tools__search" placeholder="Type Evénement">
        </th>
        <th>
          <input type="text" [(ngModel)]="isFreeFilter" (input)="filter('isFree', isFreeFilter)"
            class="form__input tools__search" placeholder="Gratuit">
        </th>
        <th>
          <input type="text" [(ngModel)]="participantsNbFilter" (input)="filter('participantsNb', participantsNbFilter)"
            class="form__input tools__search" placeholder="Participants">
        </th>
        <th>
          <input type="text" [(ngModel)]="institutionFilter" (input)="filter('institution', institutionFilter)"
            class="form__input tools__search" placeholder="Institution">
        </th>
        <th>
          <input type="text" [(ngModel)]="committeeLeaderFilter"
            (input)="filter('committeeLeader', committeeLeaderFilter)" class="form__input tools__search"
            placeholder="Responsable">
        </th>

      </tr>
    </thead>
    <tbody class="list">
      <tr class="list--list-item" *ngFor="let request of filteredRequests; let i = index">
        <td class="customtooltip">
          <i class="far fa-clock"></i>
          <span class="customtooltiptext">
            Date Création : {{request.creationDate}} <br />
            Date Modification : {{request.lastModifDate}}
          </span></td>
        <td class="customtooltip">
          <i class="fas fa-info-circle "></i>
          <span class="customtooltiptext">
            Addresse : {{request.address}} <br />
            Téléphone : {{request.phone}} <br />
            Email : {{request.email}} <br />
            Site Web : {{request.webSite}} <br />
            Réseaux Sociaux : <br />
            <span *ngFor="let link of request.socialNetworks; let k = index">
              {{link}} <br />
            </span>
          </span>
        </td>
        <td class="customtooltip">
          <i class="fas fa-tasks"></i>
          <span class="customtooltiptext">
            <span *ngIf="request.benefits && request.benefits.length > 0; else noBenefits">
              <span *ngFor="let benefit of request.benefits; let j = index">
                {{ benefit?.label || 'Pas de prestations demandées' }} <br />
              </span>
            </span>
            <ng-template #noBenefits>
              Pas de prestations demandées
            </ng-template>
          </span></td>
        <td class="">{{request.code}}</td>
        <td class="">{{request.label}}</td>
        <td class="">{{request.description}}</td>
        <td class="">{{request.type?.label}}</td>
        <td>{{ request.isFree ? 'Oui' : 'Non' }}</td>
        <td class="">{{request.participantsNb}}</td>
        <td class="">{{request.institution}}</td>
        <td class="">{{request.committeeLeader}}</td>

      </tr>
    </tbody>
  </table>
</div>
